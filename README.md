# Automated UML Refactoring Pipeline using RCA and LLM

## Project Overview

This project implements a complete Model Driven Engineering (MDE) pipeline aimed at automating the refactoring of UML class diagrams (Ecore models). By combining Relational Concept Analysis (RCA) for structural detection and Large Language Models (LLM) for semantic analysis, the system automatically identifies abstractions (Abstract Classes or Interfaces) and reconstructs the model hierarchy to reduce redundancy.

## Functional Workflow

The pipeline operates in four sequential stages:

1.  **Data Extraction (Java/EMF):** Parses the input `.ecore` model and extracts class signatures (attributes and operations) into a Relational Context Family (RCFT) format.
2.  **Structural Analysis (Python/RCA):** Processes the RCFT file to build a concept lattice, identifying groups of classes sharing common properties.
3.  **Semantic Consultation (Python/GenAI):** Submits identified candidates to the Google Gemini API. The AI acts as a software architect to determine the appropriate refactoring strategy (Inheritance vs. Interface) and proposes semantic naming.
4.  **Model Reconstruction (Java/EMF):** Applies the refactoring plan generated by the AI directly to the original model, moving attributes/methods and creating the necessary generalization links.

## Technical Architecture

* **Language:** Java 17 (Core Logic, EMF manipulation) & Python 3.10+ (Data Science, AI integration).
* **Modeling Framework:** Eclipse Modeling Framework (EMF).
* **AI Provider:** Google Gemini API (via `google-generativeai`).
* **Build System:** Maven.

## Prerequisites

Ensure the following tools are installed on your environment:

* Java Development Kit (JDK) 17 or higher.
* Apache Maven.
* Python 3.10 or higher.
* **Python Dependencies:**
    ```bash
    pip install concepts google-generativeai
    ```

## Configuration

The project requires a valid Google Gemini API Key to perform semantic analysis.

1.  Obtain an API Key from Google AI Studio.
2.  Set the environment variable in your terminal before running the project:
    ```bash
    export GOOGLE_API_KEY="your_api_key_here"
    ```

## Installation and Usage

1.  **Clone the repository:**
    ```bash
    git clone <repository_url>
    cd <project_directory>
    ```

2.  **Place Ecore Models:**
    Ensure your input `.ecore` files are located in `src/main/resources/`.

3.  **Execute the Pipeline:**
    Use the provided shell script to compile and run the workflow. You can specify a target model file as an argument.
    ```bash
    chmod +x run_pipeline.sh
    ./run_pipeline.sh transport.ecore
    ```
    If no argument is provided, the script will prompt for a filename interactively.

## Outputs and Metrics

Upon successful execution, the system generates:

* **`[filename]_refactore.ecore`**: The optimized UML model.
* **`plan_amelioration.json`**: The decision log produced by the AI architect.
* **Execution Report**: A console summary displaying Key Performance Indicators (KPIs), including:
    * Number of new abstractions created.
    * Number of factored methods and attributes.
    * Total redundancy removed.

## Project Structure

* `src/main/java/org/example`: Contains Java source code for extraction, orchestration, and refactoring logic.
* `src/main/resources`: Contains Python scripts (`llm.py`, `treillis.py`) and Ecore model files.
* `run_pipeline.sh`: Main entry point script for building and executing the project.

## License

This project is developed for educational purposes as part of the Model Driven Engineering module.
